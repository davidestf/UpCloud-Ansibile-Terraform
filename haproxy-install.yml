---
- name: install haproxy

  hosts: loadbalancer
#privatest.org
 # remote_user: root
  become: true
#  vars:
#hostname: ubun    
#servername: ubun
# ssh_keys:
 #          -  ssh-rsa AAAAB3NzaC1yc2EAA[...]1SLB0d7z ds@eclipse

  tasks:
   - name: install haproxy
     apt:
       name: haproxy
       state: present

   - name: Generate ha-proxy configuration file
     template:
       src: haproxy.cfg
       dest: "/etc/haproxy/haproxy.cfg"
#       owner: root
#       group: root
#       mode: 0600
#     tags:
#       - haproxy
#      - restart haproxy
   - name: "start service of haproxy"
     service:
       name: "haproxy"
       state: restarted